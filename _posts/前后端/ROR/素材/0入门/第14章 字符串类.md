# 第十四章 字符串类



## 14.1 字符串的创建

`#{}` 内嵌表达式

`\` 转义的特殊字符

* `\t`，水平制表符
* `\n`，换行符
* `\r`，回车
* `\s`，空格

使用 `%Q(..)` 相当于用 `" "` 创建字符串

使用 `%q(..)` 则相当于用 `' '` 创建字符串。

用 `" "` 括住的字符串中可以使用转义字符和内嵌表达式，而用 `' '` 括住的字符串则不会做任何特殊处理，只会原封不动地显示。另外，使用既没有 `" "` 也没有 `' '` 的字符串时，则会被认为是用 `" "` 创建的字符串。



`printf` 方法的第 1 个参数表示字符串的输出格式。而从第 2 个参数开始，往后的参数都会被依次嵌入到格式中 `%` 所对应的位置。%d 是整数，%4d 是四位整数，-8 表示左对齐的 8 位。

```
# 指定整数的格式
n = 123
printf("%d\n", n)   #=> 123
printf("%4d\n", n)  #=>  123
printf("%04d\n", n) #=> 0123
printf("%+d\n", n)	#=> +123

# 指定字符串的格式
n = "Ruby"
printf("Hello,%s!\n", n)   #=> Hello,Ruby!
printf("Hello,%8s!\n", n)	 #=> Hello,    Ruby!
printf("Hello,%-8s!\n", n) #=> Hello,Ruby    !
```

`sprintf`，把 `printf` 的输出内容转换位字符串对象

`length`，字符串长度



## 14.2 获取字符串的长度

`size`，字符串长度

`bytesize`，字节数

`.empty?`，是否为空



## 14.3 字符串的索引

`str(num)`，字符串索引位置



## 14.4 字符串的连接

`str1 + str2` 『创建新字符串』

`str1 << str2` 『破坏性』覆盖 str1，效果同 `str1.concat(str2) `



## 14.5 字符串的比较

`a == b`，等于

`a != b`，不等于

`a > b`，大于

`a < b`，小于

UTF-8 就是 Unicode 的一种编码方式，在非 Windows 平台下的中文字符一般都使用 UTF-8 编码。



## 14.6 字符串的分割

`split`，字符串分割为数组，返回数组

```
str = "高桥:gaoqiao:1234567:000-123-4567"
str.split(/:/)  #=> ["高桥", "gaoqiao", "1234567", "000-123-4567"]
```



## 14.7 换行符的使用方法

`chop`，删除最后一个任意字符（包括换行符），『创建新的字符串』

`chomp`，删除最后一个换行符，『创建新的字符串』

用 `each_line` 方法循环读取新的行时，一般会使用具有破坏性的 `chomp!` 方法直接删除换行符。

```
f.each_line do |line|
line.chomp!
　处理line
end
```



## 14.8 字符串的检索和置换

`a.index(b)` ，从左到右检查字符串中是否存在参数指定的字符串

`a.rindex(b)` ，从右到左检查字符串中是否存在参数指定的字符串

`sub`，字符串替换（置换），详见第十六章

`gsub`，字符串替换（置换），详见第十六章



## 14.9 14.10 字符串与数组的共同方法

**（a）与索引操作相关的方法**

**（b）与 Enumerable 模块相关的方法**

**（c）与连接、反转（reverse）相关的方法**

### 破坏性

赋值：`a[n] = str`、`a[n..m] = str`、`a[n, len] = str`，表示从 *a* [*n*] 开始，获取之后的 *len* 个元素，赋值

```
a="aaabbb"
a[1, 3] = "D"
a  #=> "aDbb"
```

`concat`，效果同 +

### 创建新字符串

`a.slice(b)`、`a.slice(n..m)`、`a.slice(n, len)`，删除字符串 a 的一部分，并返回删除的部分

`each_byte`，按字节遍历

`each_char`，按字符遍历

`each_line`，按行遍历

```
str = "壹\n 贰\n 叁\n"
foo = str.each_line.collect{|line| line.chomp * 3}
bar = str.each_line.map{|line| line.chop }
foo  #=> ["壹壹壹", "贰贰贰", "叁叁叁"]
bar  #=> ["壹", " 贰", " 叁"]
```

`a + b`，加

`a.delete(b)`，从 a 中删除字符串 b

`a.reverse`，反转

`a.strip`，删除开头和结尾的空格

`a.upcase`，转大写

`a.downcase`，转小写

`a.swapcase`，大写转小，小写转大

`a.capitalize`，首字母大写

`a.tr`，置换字符，与 `gsub` 类似，但可以一次替换多个字符。比如 `a.tr("a-z", "A-Z")`。相反，`tr` 方法不能使用正则表达式，也不能指定两个字符以上的字符串。



## 14.11 日语字符编码的转换

