# 第十九章 Encoding 类



## 19.1 Ruby 的编码与字符串

Ruby 会按照以下信息决定字符串对象的编码，或者在输入 / 输出处理时转换编码

* **脚本编码**：决定字面量字符串对象编码的信息，与脚本的字符编码一致。
* **内部编码与外部编码**：内部编码是指从外部获取的数据在程序中如何处理的信息。与之相反，外部编码是指程序向外部输出时与编码相关的信息。两者都与 `IO` 对象有关联。



## 19.2 脚本编码与魔法注释

我们把指定脚本编码的注释称为魔法注释

魔法注释必须写在脚本的首行（第 1 行以 `#! ～` 开头时，则写在第 2 行）。下面是将脚本编码指定为 UTF-8 的例子。

```
# encoding: utf-8
```

兼容 Emacs、VIM 等编辑器的编码指定方式

```
# -*- coding: utf-8 -*-        # 编辑器为Emacs 的时候
# vim:set fileencoding=utf-8:  # 编辑器为VIM 的时候
```



## 19.3 Encoding 类

在进行（字符串/正则表达式等）比较时，如果编码不一样，即使表面的值相同，程序也会将其判断为不同的字符串



## 19.4 正则表达式与编码



## 19.5 IO 类与编码

每个 `IO` 对象都包含有外部编码与内部编码两种编码信息。

外部编码指的是作为输入 / 输出对象的文件、控制台等的编码，内部编码指的是 Ruby 脚本中的编码。

编码原本就只是用来说明如何处理字符的信息

`io.set_encoding(encoding)` 以 " 外部编码名 : 内部编码名 " 的形式指定字符串 *encoding*

`File.open(file, "mode:encoding")` 打开文件 *file* 时指定编码 *encoding*

