---
layout: post
title: 终端 + oh-my-zsh 基本插件
categories: 工具-终端Shell
---
【精】最简单oh-my-zsh mac版基本插件安装-菜鸟实操整理：<https://www.jianshu.com/p/59a3f1601cfc>

## 常见报错
Zsh show fail every time when I open my terminal：<https://stackoverflow.com/questions/29283187/zsh-show-fail-every-time-when-i-open-my-terminal>
```
sudo vi /etc/zshenv
填写：
# system-wide environment settings for zsh(1)
if [ -x /usr/libexec/path_helper ]; then
  eval `/usr/libexec/path_helper -s`
fi 
```

## 安装 oh-my-zsh 及基本用法 
```
sh -c "$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)"
```
### vim 基本用法：
1）编辑配置
```
vi ~/.zshrc
```
2）搜索关键词：`输入 n 和 shift+n 上下移动 `
3）应用配置
```
source ~/.zshrc
```

## 1.1 修改主题
进入文件
```
vi ~/.zshrc
```
修改主题
```
# ZSH_THEME="robbyrussell"
ZSH_THEME="agnoster"
```
![img](https://upload-images.jianshu.io/upload_images/99476-5091a9e0ce90bb11.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/529)

应用配置
```
source ~/.zshrc
```

## 1.2 安装 Powerline
```
# 用 pip 工具来安装这个字体
sudo easy_install pip
# 安装 powerline
pip install -user powerline-status
```

## 1.3 安装 Powerline 字体（针对 Agnoster 主题）
```
# 下载字体
git clone https://github.com/powerline/fonts ~/Downloads/fonts 
# 进入文件夹
cd ~/Downloads/fonts
# 安装字体
./install.sh
```
安装好字体之后的即时画面，需要在配置里选择字体才能有最终效果
![img](https://upload-images.jianshu.io/upload_images/99476-d102687fdec4f647.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/547)

## 1.4 导入色彩预设 Argonaut
1）下载配色方案
```
git clone https://github.com/mbadolato/iTerm2-Color-Schemes ~/Downloads/colors
```
2）打开 `~/Downloads/colors/terminal/Argonaut.terminal`
![img](https://upload-images.jianshu.io/upload_images/99476-d102687fdec4f647.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/547)  

3）终端-设置-选择字体（powerline）
Roboto Mono Light for Powerline，13号
![img](https://upload-images.jianshu.io/upload_images/99476-6d14d857bbe2224c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/648)

## 1.5 zsh docker auto-complete
参考资料：<https://docs.docker.com/compose/completion/#bash>
```
# 新建文件夹
mkdir -p ~/.zsh/completion
# 安装 docker 自动补全
curl -L https://raw.githubusercontent.com/docker/docker-ce/master/components/cli/contrib/completion/zsh/_docker > ~/.zsh/completion/_docker
# 安装 docker-compose 自动补全
curl -L https://raw.githubusercontent.com/docker/compose/1.22.0/contrib/completion/zsh/_docker-compose > ~/.zsh/completion/_docker-compose
```

## ~/.zshrc 最终配置
廖雪峰 git alias 别名：<https://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000/001375234012342f90be1fc4d81446c967bbdc19e7c03d3000>
```ruby
# 远程复制：rsync -auvzP ~/local_path admin@ip:~/vps_path
# oh-my-zsh
export ZSH="/Users/aaron/.oh-my-zsh" #oh-my-zsh 路径
ZSH_THEME="agnoster" #主题 #ZSH_THEME="robbyrussell"

# 环境配置
HISTSIZE=100000 && SAVEHIST=100000 #显示多少行代码
export LC_ALL=en_US.UTF-8 && export LANG=en_US.UTF-8 #utf-8编码（解决mosh编码问题）
export PATH="/usr/local/sbin:$PATH" #homebrew's sbin路径
export PATH=$PATH:/usr/local/mysql/bin #Mysql 路径
export PATH="$HOME/.rbenv/bin:$PATH" && eval "$(rbenv init -)" #rbenv设置ruby默认版本

# 插件
plugins=(autojump zsh-autosuggestions zsh-syntax-highlighting git Z brew node npm rails ruby gem kubectl vscode docker) #其他插件：bundle,cap,github,osx
source $ZSH/oh-my-zsh.sh #让插件生效
source <(kubectl completion zsh) #K8s自动补全（kubernetes autocomplete）

# 别名
## 终端科学上网（Shadowsocks-偏好设置-高级-本地Socks5监听端口，默认1086）
alias proxy='export all_proxy=socks5://127.0.0.1:1086' #开启 Shadowsocks
alias unproxy='unset all_proxy' #关闭 Shadowsocks
alias gl='git log --pretty=oneline' # git log显示
alias dd1='ddcctl -d 1 -b' #显示器1亮度
alias dd2='ddcctl -d 2 -b' #显示器2亮度
alias cats='pygmentize -O style=monokai -f console256 -g' #cats 打印时高亮
alias code='/Applications/Visual\ Studio\ Code.app/Contents/Resources/app/bin/code' #终端打开vscode（用 code .）

# 历史命令ctrl+r
function exists { which $1 &> /dev/null }
if exists percol; then
    function percol_select_history() {
        local tac
        exists gtac && tac="gtac" || { exists tac && tac="tac" || { tac="tail -r" } }
        BUFFER=$(fc -l -n 1 | eval $tac | percol --query "$LBUFFER")
        CURSOR=$#BUFFER         # move cursor
        zle -R -c               # refresh
    }
    zle -N percol_select_history
    bindkey '^R' percol_select_history
fi

# 隐藏路径的 path_name 和 host_name
prompt_dir() {prompt_segment blue black '%c'}
prompt_context() {
  if [[ "$USER" != "$DEFAULT_USER" || -n "$SSH_CLIENT" ]]; then
  fi
}
```